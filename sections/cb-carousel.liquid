{% comment %}
  Section: cb-media-carousel.liquid (drag/throw version)
  - Drag/throw carousel (no autoplay)
  - Choose columns per breakpoint (desktop up to 5)
  - Overflows to right edge of the screen (viewport bleed)
  - Preserves existing block rendering: we wrap each direct child of {{ children }} into slides via JS
{% endcomment %}

{% liquid
  assign section_id = section.id
  assign heading = section.settings.heading
%}

{%- capture children -%}
  {% content_for 'blocks' %}
{%- endcapture -%}

<div class="section-background color-{{ section.settings.color_scheme }}"></div>
<section id="cb-media-carousel-{{ section_id }}" class="kmc section section--{{ section.settings.section_width }}
  color-{{ section.settings.color_scheme }} spacing-style"
  style="{% render 'spacing-style', settings: section.settings %}">
  <div class="kmc__inner {{ section.settings.section_width }}">
    {% if heading != blank %}
      <div class="kmc__heading">
        <h2>{{ heading }}</h2>
      </div>
    {% endif %}

   <!-- Slider main container -->
<div class="swiper">
  <!-- Additional required wrapper -->
  <div class="swiper-wrapper group-block--height-fill">
    <!-- Slides -->
   {{ children }}
  </div>
  <!-- If we need pagination -->
  <div class="swiper-pagination"></div>

  <!-- If we need navigation buttons -->
  <div class="swiper-button-prev"></div>
  <div class="swiper-button-next"></div>

  <!-- If we need scrollbar -->
  <div class="swiper-scrollbar"></div>
</div>

  </div>
</section>
<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/swiper@12/swiper-bundle.min.css"
/>

<script src="https://cdn.jsdelivr.net/npm/swiper@12/swiper-bundle.min.js"></script>
<script>
const swiper = new Swiper('.swiper', {
  // Default parameters
  slidesPerView: 1,
  spaceBetween: 10,
  // Responsive breakpoints
  breakpoints: {
    // when window width is >= 320px
    320: {
      slidesPerView: 1.2,
      spaceBetween: 18
    },
    // when window width is >= 768px
    768: {
      slidesPerView: 3.2,
      spaceBetween: 18
    },
    // when window width is >= 990px
    990: {
      slidesPerView: 4.2,
      spaceBetween: 18
    },
       // when window width is >= 990px
    1280: {
      slidesPerView: 5,
      spaceBetween: 18
    }
  }
})
  </script>
<style>.kmc__heading{
  margin-bottom:18px;
  text-align:center;}


.kmc__inner.full-width{ 
  padding:0;} 
.kmc__inner.full-width .swiper{
padding-inline-start: var(--util-page-margin-offset);
scroll-padding-inline-start: var(--util-page-margin-offset);
padding-inline-end: var(--util-page-margin-offset);}

/* 1) Make Swiper stretch slides to tallest card */
.kmc .swiper-wrapper {
  align-items: stretch;         /* key: equal heights across row */
}

/* 2) Let each slide participate in stretching */
.kmc .swiper-slide {
  height: auto;                 /* don't lock slide height */
  display: flex;                /* so inner card can stretch */
}


</style>
{% schema %}
{
  "name": "CB Carousel)",
  "tag": "section",
  "class": "cb-media-carousel-section",
  "settings": [
    { "type": "text", 
      "id": "heading", 
      "label": "Heading" },

    { "type": "header", 
      "content": "t:content.section_layout" },
    {
      "type": "select",
      "id": "section_width",
      "label": "t:settings.width",
      "options": [
        { "value": "page-width", "label": "t:options.page" },
        { "value": "full-width", "label": "t:options.full" }
      ],
      "default": "page-width"
    },



    { "type": "header", 
      "content": "t:content.padding" },
    {
      "type": "range",
       "id": "padding-block-start",
        "label": "t:settings.top",
      "min": 0,
       "max": 100, 
      "step": 1,
       "unit": "px", 
       "default": 0
    },
    {
      "type": "range",
       "id": "padding-block-end", 
       "label": "t:settings.bottom",
      "min": 0, 
      "max": 100, 
      "step": 1, 
      "unit": "px", 
      "default": 0
    }
  ],
  "blocks": [
    { "type": "cb-slide" },
    { "type": "group" }
  ],
  "max_blocks": 50,
  "presets": [
    { "name": "CB Carousel", "category": "Layout" }
  ]
}
{% endschema %}
